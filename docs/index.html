<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EventCalendar с двумя колонками и зумом месяца</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@event-calendar/build@4.5.0/dist/event-calendar.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/@event-calendar/build@4.5.0/dist/event-calendar.min.js"></script>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
    }
    #ec {
      max-width: 900px;
      margin: 20px auto;
      /* начальный масштаб для месяца */
      --month-zoom: 1;
    }

    /* Поддержка зума месяца: меняем масштаб шрифта и высоту ячеек */
    .ec-day-grid-view[style*="display: block"] {
      transform-origin: top left;
      transform: scale(var(--month-zoom));
    }

    /* Немного отделим колонки для ресурсов */
    .ec-time-grid .ec-resource-column {
      border-right: 1px solid #ccc;
    }
  </style>
</head>
<body>

  <div id="ec"></div>

  <script>
    const ec = EventCalendar.create(document.getElementById('ec'), {
      view: 'timeGridWeek',
      headerToolbar: {
        start: 'prev,next today',
        center: 'title',
        end: 'dayGridMonth,timeGridWeek,timeGridDay'
      },
      resources: [
        { id: 'natalia', title: 'Наталья' },
        { id: 'irina', title: 'Ирина' }
      ],
      scrollTime: '09:00:00',
      events: createEvents(),
      views: {
        timeGridDay: { pointer: true },
        timeGridWeek: { pointer: true },
        dayGridMonth: {
          pointer: true,
          // ресурсные колонки в месяце не поддерживаются EventCalendar
        }
      },
      dayMaxEvents: true,
      nowIndicator: true,
      selectable: true
    });

    // Функция для генерации событий, сегодня - сдвиг на день недели для выравнивания недели
    function createEvents() {
      let days = [];
      for (let i = 0; i < 7; ++i) {
        let day = new Date();
        let diff = i - day.getDay();
        day.setDate(day.getDate() + diff);
        days[i] = day.getFullYear() + "-" + _pad(day.getMonth()+1) + "-" + _pad(day.getDate());
      }

      return [
        {start: days[0] + " 10:00", end: days[0] + " 12:00", resourceId: 'natalia', title: "Запись у Натальи"},
        {start: days[0] + " 13:00", end: days[0] + " 15:00", resourceId: 'irina', title: "Запись у Ирины"},
        {start: days[1] + " 09:00", end: days[1] + " 11:00", resourceId: 'natalia', title: "Процедура у Натальи"},
        {start: days[1] + " 12:00", end: days[1] + " 14:00", resourceId: 'irina', title: "Звонок Ирине"},
        // для месяца добавим пару событий
        {start: days[3], end: days[3], resourceId: 'natalia', title: "Событие в месяце" },
        {start: days[4], end: days[4], resourceId: 'irina', title: "Другое событие" }
      ];
    }

    function _pad(num) {
      let norm = Math.floor(Math.abs(num));
      return (norm < 10 ? '0' : '') + norm;
    }

    ec.render();

    // ---- Реализация зума месяца через Ctrl + колесо мыши ----
    const ecEl = document.getElementById('ec');
    ecEl.addEventListener('wheel', e => {
      // Проверяем что мы в месячном режиме (dayGridMonth вид)
      if (ec.getView().name === 'dayGridMonth' && (e.ctrlKey || e.metaKey)) {
        e.preventDefault();

        let currentZoom = parseFloat(getComputedStyle(ecEl).getPropertyValue('--month-zoom')) || 1;
        let delta = e.deltaY > 0 ? -0.1 : 0.1;
        let newZoom = Math.min(Math.max(currentZoom + delta, 0.6), 2);

        ecEl.style.setProperty('--month-zoom', newZoom.toFixed(2));
      }
    }, { passive: false });
  </script>

</body>
</html>
