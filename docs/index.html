<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>EventCalendar</title>

  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="site.webmanifest">
  <link rel="stylesheet" href="global.css?20231021">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@event-calendar/build@4.5.0/dist/event-calendar.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@event-calendar/build@4.5.0/dist/event-calendar.min.js"></script>

  <style>
    .ec-timeline .ec-time, .ec-timeline .ec-line {
      width: 16px;
    }
    .ec-timeline .ec-time {
      overflow: visible;
    }
    .ec-timeline .ec-time time {
      display: inline-block;
      width: 64px;
      text-align: center;
    }
  </style>
</head>

<body>

<header class="row">
  <button class="toggle-dark-button" title="Toggle dark mode" onclick="document.body.classList.toggle('ec-dark')">
    <!-- Тёмная/светлая тема -->
    <svg class="light" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path></svg>
    <svg class="dark" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194..." fill="currentColor"></path></svg>
  </button>
</header>

<main class="row">
  <div id="ec" class="col" style="touch-action: manipulation;"></div>
</main>

<script type="text/javascript">
  const ec = EventCalendar.create(document.getElementById('ec'), {
    view: 'resourceTimeGridDay',
    headerToolbar: {
      start: 'prev,next today',
      center: 'title',
      end: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek resourceTimeGridWeek,resourceTimelineWeek'
    },
    resources: [
      {id: 1, title: 'Наталья'},
      {id: 2, title: 'Ирина'}
    ],
    scrollTime: '09:00:00',
    events: createEvents(),
    dayMaxEvents: true,
    nowIndicator: true,
    selectable: true
  });

  function createEvents() {
    let days = [];
    for (let i = 0; i < 7; ++i) {
      let day = new Date();
      let diff = i - day.getDay();
      day.setDate(day.getDate() + diff);
      days[i] = day.getFullYear() + "-" + _pad(day.getMonth()+1) + "-" + _pad(day.getDate());
    }

    return [
      {start: days[0] + " 00:00", end: days[0] + " 09:00", resourceId: 1, display: "background"},
      {start: days[1] + " 12:00", end: days[1] + " 14:00", resourceId: 2, display: "background"},
      {start: days[2] + " 17:00", end: days[2] + " 24:00", resourceId: 1, display: "background"},
      {start: days[0] + " 10:00", end: days[0] + " 14:00", resourceId: 1, title: "The calendar can display background and regular events", color: "#FE6B64"},
      {start: days[1] + " 16:00", end: days[2] + " 08:00", resourceId: 2, title: "An event may span to another day", color: "#B29DD9"},
      {start: days[2] + " 09:00", end: days[2] + " 13:00", resourceId: 2, title: "Events can be assigned to resources", color: "#779ECB"},
      {start: days[3] + " 14:00", end: days[3] + " 20:00", resourceId: 1, title: "", color: "#FE6B64"},
      {start: days[3] + " 15:00", end: days[3] + " 18:00", resourceId: 1, title: "Overlapping events", color: "#779ECB"},
      {start: days[5] + " 10:00", end: days[5] + " 16:00", resourceId: 2, title: "You control event display", color: "#779ECB"},
      {start: days[5] + " 14:00", end: days[5] + " 19:00", resourceId: 2, title: "You can drag events!", color: "#FE6B64"},
      {start: days[5] + " 18:00", end: days[5] + " 21:00", resourceId: 2, title: "", color: "#B29DD9"},
      {start: days[1], end: days[3], resourceId: 1, title: "All-day events at the top", color: "#B29DD9", allDay: true}
    ];
  }

  function _pad(num) {
    let norm = Math.floor(Math.abs(num));
    return (norm < 10 ? '0' : '') + norm;
  }

  // === ДВОЙНОЙ ТАП ===
  let lastTapTime = 0;
  document.getElementById('ec').addEventListener('touchend', function(e) {
    const now = Date.now();
    if (now - lastTapTime < 300) {
      // Сработал двойной тап
      ec.setOption('view', 'resourceTimeGridWeek');
    }
    lastTapTime = now;
  });
</script>

</body>
</html>
